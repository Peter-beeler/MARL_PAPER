2026-02-24 10:13:51.740390: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-02-24 10:13:51.740391: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-02-24 10:13:51.740390: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-02-24 10:13:51.740405: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1771946031.753808 1070479 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1771946031.753807 1070478 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1771946031.753817 1070480 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1771946031.754132 1070481 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1771946031.757929 1070478 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1771946031.757929 1070479 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1771946031.757930 1070480 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1771946031.758134 1070481 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1771946031.769507 1070480 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769509 1070479 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769507 1070478 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769510 1070481 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769525 1070479 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769526 1070478 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769526 1070480 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769526 1070481 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769528 1070479 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769529 1070478 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769529 1070480 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769530 1070481 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769531 1070479 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769531 1070478 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769532 1070480 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1771946031.769532 1070481 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2026-02-24 10:13:51.772905: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-02-24 10:13:51.772904: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-02-24 10:13:51.772905: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-02-24 10:13:51.773090: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
usage: grpo_text_action.py [-h] [--model_name MODEL_NAME]
                           [--thinking_tokens THINKING_TOKENS]
                           [--use_two_stage] [--no_two_stage]
                           [--logprob_mode {action,action+thinking}]
                           [--loss_type {grpo,drgrpo}]
                           [--num_episodes NUM_EPISODES]
                           [--episodes_per_update EPISODES_PER_UPDATE]
                           [--episodes_per_gpu EPISODES_PER_GPU]
                           [--num_agents NUM_AGENTS]
                           [--max_env_steps MAX_ENV_STEPS]
                           [--eat_reward EAT_REWARD]
                           [--clean_reward CLEAN_REWARD]
                           [--learning_rate LEARNING_RATE]
                           [--output_dir OUTPUT_DIR] [--device DEVICE]
                           [--seed SEED] [--use_4bit] [--use_8bit] [--no_lora]
                           [--use_accelerate]
                           [--num_inner_epochs NUM_INNER_EPOCHS]
                           [--minibatch_size MINIBATCH_SIZE]
                           [--samples_per_micro_batch SAMPLES_PER_MICRO_BATCH]
                           [--micro_batch_size MICRO_BATCH_SIZE] [--visualize]
                           [--viz_save_file VIZ_SAVE_FILE] [--viz_use_ref]
                           [--sanity_check] [--skip_pre_eval]
                           [--skip_post_eval]
                           [--num_eval_episodes NUM_EVAL_EPISODES]
                           [--eval_interval EVAL_INTERVAL] [--log_trajectory]
                           [--no_log_trajectory]
                           [--trajectory_log_file TRAJECTORY_LOG_FILE]
                           [--use_wandb] [--no_wandb]
                           [--wandb_project WANDB_PROJECT]
                           [--wandb_entity WANDB_ENTITY]
                           [--wandb_run_name WANDB_RUN_NAME]
grpo_text_action.py: error: unrecognized arguments: --action_tokens 128
usage: grpo_text_action.py [-h] [--model_name MODEL_NAME]
                           [--thinking_tokens THINKING_TOKENS]
                           [--use_two_stage] [--no_two_stage]
                           [--logprob_mode {action,action+thinking}]
                           [--loss_type {grpo,drgrpo}]
                           [--num_episodes NUM_EPISODES]
                           [--episodes_per_update EPISODES_PER_UPDATE]
                           [--episodes_per_gpu EPISODES_PER_GPU]
                           [--num_agents NUM_AGENTS]
                           [--max_env_steps MAX_ENV_STEPS]
                           [--eat_reward EAT_REWARD]
                           [--clean_reward CLEAN_REWARD]
                           [--learning_rate LEARNING_RATE]
                           [--output_dir OUTPUT_DIR] [--device DEVICE]
                           [--seed SEED] [--use_4bit] [--use_8bit] [--no_lora]
                           [--use_accelerate]
                           [--num_inner_epochs NUM_INNER_EPOCHS]
                           [--minibatch_size MINIBATCH_SIZE]
                           [--samples_per_micro_batch SAMPLES_PER_MICRO_BATCH]
                           [--micro_batch_size MICRO_BATCH_SIZE] [--visualize]
                           [--viz_save_file VIZ_SAVE_FILE] [--viz_use_ref]
                           [--sanity_check] [--skip_pre_eval]
                           [--skip_post_eval]
                           [--num_eval_episodes NUM_EVAL_EPISODES]
                           [--eval_interval EVAL_INTERVAL] [--log_trajectory]
                           [--no_log_trajectory]
                           [--trajectory_log_file TRAJECTORY_LOG_FILE]
                           [--use_wandb] [--no_wandb]
                           [--wandb_project WANDB_PROJECT]
                           [--wandb_entity WANDB_ENTITY]
                           [--wandb_run_name WANDB_RUN_NAME]
grpo_text_action.py: error: unrecognized arguments: --action_tokens 128
usage: grpo_text_action.py [-h] [--model_name MODEL_NAME]
                           [--thinking_tokens THINKING_TOKENS]
                           [--use_two_stage] [--no_two_stage]
                           [--logprob_mode {action,action+thinking}]
                           [--loss_type {grpo,drgrpo}]
                           [--num_episodes NUM_EPISODES]
                           [--episodes_per_update EPISODES_PER_UPDATE]
                           [--episodes_per_gpu EPISODES_PER_GPU]
                           [--num_agents NUM_AGENTS]
                           [--max_env_steps MAX_ENV_STEPS]
                           [--eat_reward EAT_REWARD]
                           [--clean_reward CLEAN_REWARD]
                           [--learning_rate LEARNING_RATE]
                           [--output_dir OUTPUT_DIR] [--device DEVICE]
                           [--seed SEED] [--use_4bit] [--use_8bit] [--no_lora]
                           [--use_accelerate]
                           [--num_inner_epochs NUM_INNER_EPOCHS]
                           [--minibatch_size MINIBATCH_SIZE]
                           [--samples_per_micro_batch SAMPLES_PER_MICRO_BATCH]
                           [--micro_batch_size MICRO_BATCH_SIZE] [--visualize]
                           [--viz_save_file VIZ_SAVE_FILE] [--viz_use_ref]
                           [--sanity_check] [--skip_pre_eval]
                           [--skip_post_eval]
                           [--num_eval_episodes NUM_EVAL_EPISODES]
                           [--eval_interval EVAL_INTERVAL] [--log_trajectory]
                           [--no_log_trajectory]
                           [--trajectory_log_file TRAJECTORY_LOG_FILE]
                           [--use_wandb] [--no_wandb]
                           [--wandb_project WANDB_PROJECT]
                           [--wandb_entity WANDB_ENTITY]
                           [--wandb_run_name WANDB_RUN_NAME]
grpo_text_action.py: error: unrecognized arguments: --action_tokens 128
usage: grpo_text_action.py [-h] [--model_name MODEL_NAME]
                           [--thinking_tokens THINKING_TOKENS]
                           [--use_two_stage] [--no_two_stage]
                           [--logprob_mode {action,action+thinking}]
                           [--loss_type {grpo,drgrpo}]
                           [--num_episodes NUM_EPISODES]
                           [--episodes_per_update EPISODES_PER_UPDATE]
                           [--episodes_per_gpu EPISODES_PER_GPU]
                           [--num_agents NUM_AGENTS]
                           [--max_env_steps MAX_ENV_STEPS]
                           [--eat_reward EAT_REWARD]
                           [--clean_reward CLEAN_REWARD]
                           [--learning_rate LEARNING_RATE]
                           [--output_dir OUTPUT_DIR] [--device DEVICE]
                           [--seed SEED] [--use_4bit] [--use_8bit] [--no_lora]
                           [--use_accelerate]
                           [--num_inner_epochs NUM_INNER_EPOCHS]
                           [--minibatch_size MINIBATCH_SIZE]
                           [--samples_per_micro_batch SAMPLES_PER_MICRO_BATCH]
                           [--micro_batch_size MICRO_BATCH_SIZE] [--visualize]
                           [--viz_save_file VIZ_SAVE_FILE] [--viz_use_ref]
                           [--sanity_check] [--skip_pre_eval]
                           [--skip_post_eval]
                           [--num_eval_episodes NUM_EVAL_EPISODES]
                           [--eval_interval EVAL_INTERVAL] [--log_trajectory]
                           [--no_log_trajectory]
                           [--trajectory_log_file TRAJECTORY_LOG_FILE]
                           [--use_wandb] [--no_wandb]
                           [--wandb_project WANDB_PROJECT]
                           [--wandb_entity WANDB_ENTITY]
                           [--wandb_run_name WANDB_RUN_NAME]
grpo_text_action.py: error: unrecognized arguments: --action_tokens 128
W0224 10:14:02.215000 1070450 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1070479 closing signal SIGTERM
W0224 10:14:02.215000 1070450 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1070480 closing signal SIGTERM
E0224 10:14:02.443000 1070450 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 2) local_rank: 0 (pid: 1070478) of binary: /users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/bin/python
Traceback (most recent call last):
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/bin/accelerate", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/lib/python3.11/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/lib/python3.11/site-packages/accelerate/commands/launch.py", line 1185, in launch_command
    multi_gpu_launcher(args)
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/lib/python3.11/site-packages/accelerate/commands/launch.py", line 810, in multi_gpu_launcher
    distrib_run.run(args)
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/lib/python3.11/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/PAS2056/mypeter8219/miniconda3/envs/py311LLM/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
grpo_text_action.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-24_10:14:02
  host      : a0024.ten.osc.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 2 (pid: 1070481)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-24_10:14:02
  host      : a0024.ten.osc.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 2 (pid: 1070478)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
